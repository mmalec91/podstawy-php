Programowanie obiektowe - c.d.

1. Konstruktory i ich parametry

Konstruktor bezparametrowy ma definicję:


class Osoba
{
    private $imie;

    private $nazwisko;

    public function __construct()
    {
    }

    public setImie($imie)
    {
    }

    public setNazwisko($nazwisko)
    {
    }
}

Tak zdefiniowany konstruktor wywołujemy:

$obj = new Osoba();

W celu przypisania wartości do pól wywołujemy metody, np.:

$obj->setImie('Jan');
$obj->setNazwisko('Nowak');

Jeśli konstruktor ma parametr, np:

    public function __construct($imie)
    {
        $this->imie = $imie;
    }

Wtedy utowrzenie obiektu ma postać:

$obj = new Osoba('Henryk');

W przypadku definicji konstruktora:

    public function __construct($imie)

wówczas instrukcja:

    $obj = new Osoba();

będzie błędna.

Jeśli chcemy przekazać parametr w taki sposób, by był on opcjnalny, wówczas
ustalamy domyślną wartość parametru na null:


    public function __construct($imie = null)
    {
        $this->imie = $imie;
    }

Taka definicja konstruktora pozwala na wywołania:

    $o1 = new Osoba();
    $o2 = new Osoba('Krzysztof');

Rozwińmy to rozwiązanie na kilka parametrów, np. imię, nazwisko i wiek:


class Osoba
{
    private $imie;
    private $nazwisko;
    private $wiek;

    public function __construct($imie = null, $nazwisko = null, $wiek = null)
    {
        $this->imie = $imie;
        $this->nazwisko = $nazwisko;
        $this->wiek = $wiek;
    }

    public setImie($imie)
    {
    }

    public setNazwisko($nazwisko)
    {
    }

    public setWiek($wiek)
    {
    }
}

Teraz obiekty możemy konstruować następująco:

$o1 = new Osoba();
$o2 = new Osoba('Piotr');
$o3 = new Osoba('Adam', 'Kowalski');
$o4 = new Osoba('Nikodem', 'Dyzma', 49);

Wadą powyższego rozwiązania jest brak możliwości wywołania:

$o5 = new Osoba('Nowak');

Powyższe wywołanie ustali imię na Nowak.

Chcemy umożliwić wywołanie, w którym podamy tylko nazwisko.
Jak to zrobić? Możemy wykorzystać tablice. Do konstruktora
przekażemy tablicę, która będzie zawierała wartości dowolnych właściwości.

Wywołanie przyjmie postać:

$o = new Ososba(array('nazwisko' => 'Nowak'));

Implementacja takiego rozwiązania może być następująca:


    public function __construct($options)
    {

         // Czy w tablicy $options jest zawarte imie?
         // Jeśli tak, to przepisz je do składowej imie
         if (isset($options['imie'])) {
             $this->imie = $options['imie'];
         }

         // Czy w tablicy $options jest zawarte nazwisko?
         // Jeśli tak, to przepisz je do składowej nazwisko
         if (isset($options['nazwisko'])) {
             $this->nazwisko = $options['nazwisko'];
         }

         // Czy w tablicy $options jest zawarty wiek?
         // Jeśli tak, to przepisz go do składowej wiek
         if (isset($options['wiek'])) {
             $this->wiek = $options['wiek'];
         }

    }

Powyższy konstruktor umożliwia wywołania:

$o = new Ososba(array());
$o = new Ososba(array('nazwisko' => 'Nowak'));
$o = new Ososba(array('nazwisko' => 'Nowak', 'imie' => 'Stefan'));
$o = new Ososba(array('wiek' => 12, 'imie' => 'Marek'));

$o = new Ososba(array('imie' => 'John'));


Wywołanie, w którym podajemy
- tylko imię
- imię i nazwisko,
- imię, nazwisko i wiek
chcielibyśmy wywoływać:


$o = new Osoba('Piotr');
$o = new Osoba('Adam', 'Kowalski');
$o = new Osoba('Nikodem', 'Dyzma', 49);


Chcemy połączyć rozwiązania:

    $o = new Osoba('Piotr');
oraz
    $o = new Ososba(array('nazwisko' => 'Nowak'));

Implementacja takiego rozwiązania wykorzystuje funkcje sprawdzające
typ zmiennej:
   is_string()  -  wynik logiczny true mówi, że parametr jest typu string
   is_array()   -  wynik logiczny true mówi, że parametr jest tablicą
   is_integer() -  wynik logiczny true mówi, że parametr jest zmienną całkowitoliczbową


    public function __construct($options = null, $nazwisko = null, $wiek = null)
    {
         if (is_string($options)) {
             $this->imie = $options;
             if (is_string($nazwisko)) {
                 $this->nazwisko = $nazwisko;
             }
             if (is_integer($wiek)) {
                 $this->wiek = $wiek;
             }
         } else if (is_array($options) {

             // Czy w tablicy $options jest zawarte imie?
             // Jeśli tak, to przepisz je do składowej imie
             if (isset($options['imie'])) {
                 $this->imie = $options['imie'];
             }

             // Czy w tablicy $options jest zawarte nazwisko?
             // Jeśli tak, to przepisz je do składowej nazwisko
             if (isset($options['nazwisko'])) {
                 $this->nazwisko = $options['nazwisko'];
             }

             // Czy w tablicy $options jest zawarty wiek?
             // Jeśli tak, to przepisz go do składowej wiek
             if (isset($options['wiek'])) {
                 $this->wiek = $options['wiek'];
             }

         }
    }


Powyższa implementacja pozwala na wywołania:

    $o = new Osoba();
    $o = new Osoba('Piotr');
    $o = new Osoba('Piotr', 'Kowalski');
    $o = new Osoba('Piotr', 'Kowalski', 44);
    $o = new Ososba(array());
    $o = new Ososba(array('nazwisko' => 'Nowak'));
    $o = new Ososba(array(
        'nazwisko' => 'Nowak',
        'wiek' => 37
    ));
















